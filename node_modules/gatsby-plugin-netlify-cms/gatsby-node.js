"use strict";

var HtmlWebpackPlugin = require(`html-webpack-plugin`);
var HtmlWebpackIncludeAssetsPlugin = require(`html-webpack-include-assets-plugin`);

exports.modifyWebpackConfig = function (_ref, _ref2) {
  var config = _ref.config,
      stage = _ref.stage;
  var _ref2$modulePath = _ref2.modulePath,
      modulePath = _ref2$modulePath === undefined ? `${__dirname}/cms.js` : _ref2$modulePath;

  switch (stage) {
    case `develop`:
    case `build-javascript`:
      config.merge({
        entry: {
          cms: modulePath
        },
        plugins: [new HtmlWebpackPlugin({
          title: `Content Manager`,
          filename: `admin/index.html`,
          chunks: [`cms`]
        }), new HtmlWebpackIncludeAssetsPlugin({
          assets: [`https://identity.netlify.com/v1/netlify-identity-widget.js`],
          append: false,
          publicPath: false
        })]
      });
      return config;
    default:
      return config;
  }
};